{% extends "base.html" %}
{% load static %}

{% block title %}Customers{% endblock %}

{% block css %}

{% endblock css %}

{% block next_page %}
<li class="breadcrumb-item text-muted active" aria-current="page"><a
    href="{% url 'customers:dashboard' %}">Customers</a> / List
{% endblock %}

{% block head %}
Customers
{% endblock %}

{% block content %}
<div class="content-wrapper">
  <div class="container-xxl flex-grow-1 container-p-y">
    <div class="row">
      <div class="col-4 mb-3">
        <input type="text" class="form-control float-end" id="id_search" name="search" placeholder="Search" />      
      </div>
    </div>
    <div class="row">
      <div class="col-md-6 col-lg-4 col-xl-12 order-0 mb-4">
        <div class="card h-100">
          <table class="table">
            <thead>
              <tr>
                <th>No</th>
                <th>Name</th>
                <th>Contect Person</th>
                <th>Mobile</th>
                <th>Email</th>
                <th>orders</th>
                <th>Action</th>
              </tr>
            </thead>
            <tbody id="id_customers_list">
              {% for customer in customers %}
              <tr>
                <td>{{forloop.counter}}</td>
                <td>{{customer.name|upper}}</td>
                <td>{{customer.contect_person|upper}}</td>
                <td>{{customer.mobile}}</td>
                <td>{{customer.email|lower}}</td>
                <th>{{customer.orderdetails_set.count}}</th>
                <td>
                  <a href="{% url 'customers:show-customer' customer.id %}"
                                class="btn btn-primary btn-circle " title="Show details"><i class=" text-white fa-solid fa-eye"></i></i></a>
                                <a href="{% url 'orders:orders-create' customer.id %}"
                                class="btn btn-success btn-circle " title="Create Order"><i class="fa-solid fa-store"></i></a>
                </td>
              </tr>
              {% endfor %}
            </tbody>
            <tfooter>
              <th>No</th>
                <th>Name</th>
                <th>Contect Person</th>
                <th>Mobile</th>
                <th>Email</th>
                <th>orders</th>
                <th>Action</th>
            </tfooter>
          </table>    
        </div>
      </div>
    </div>
    <div class="row container-fluid mt-2">
        {% if customers.paginator.num_pages > 1 %}    
        {% include 'components/pagination.html' with items=customers paginator=customers.paginator %}
        {% endif %}
    </div>
  </div>
  <!-- / Content -->
{% endblock content %}

{% block js %}
<script>
  $('#customers-menu').addClass('active open');
  $('#customers-dashboard').addClass('active')
</script>

<script>
  $(document).on("keyup", "#id_search", function () {

    var query = this.value;
    // var category = $()
    $.ajax({
        url: '/customers/search/',
        type: 'GET',
        data: { 'query': query},
        success: function (data) {
            $('#id_customers_list').html(data.data);
        }
    });
});
</script>

{% endblock js %}