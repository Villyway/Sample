{% load static %}
<!DOCTYPE html>

<!-- =========================================================
* Sneat - Bootstrap 5 HTML Admin Template - Pro | v1.0.0
==============================================================

* Product Page: https://themeselection.com/products/sneat-bootstrap-html-admin-template/
* Created by: ThemeSelection
* License: You must have a valid license purchased in order to legally use the theme for your project.
* Copyright ThemeSelection (https://themeselection.com)

=========================================================
 -->
<!-- beautify ignore:start -->
<html
  lang="en"
  class="light-style customizer-hide"
  dir="ltr"
  data-theme="theme-default"
  data-assets-path="{% static 'assets/' %}/"
  data-template="vertical-menu-template-free"
>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />

    <title>Login Basic - Pages | Sneat - Bootstrap 5 HTML Admin Template - Pro</title>

    <meta name="description" content="" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="{% static 'assets/img/logoB.ico' %}" />

    {% include 'base/css.html' %}

    <!-- Helpers -->
    <script src="{% static 'assets/vendor/js/helpers.js' %}"></script>

    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script src="{% static 'assets/js/config.js' %}"></script>
    <link rel="stylesheet" href="{% static 'assets/extra-libs/countrycode/css/intlTelInput.css' %}">
    <link rel="stylesheet" href="{% static 'assets/extra-libs/countrycode/css/demo.css'%}">
  </head>

  <body>
    <!-- Content -->

    <div class="container-xxl">
      <div class="authentication-wrapper authentication-basic container-p-y">
        <div class="authentication-inner">
        <!-- Register Card -->
        <div class="card">
              <div class="card-body">
                <!-- Logo -->
                <div class="app-brand justify-content-center">
                  <a href="index.html" class="app-brand-link gap-2">
                    <img src="{% static 'assets/img/logo.jpeg' %}" width="120px" height = "80px">                    
                  </a>
                </div>
                <!-- /Logo -->
                <h4 class="mb-2">Adventure starts here ðŸš€</h4>
                <p class="mb-4">Make your app management easy and fun!</p>
            
                <form id="formAuthentication" class="mb-3" method="POST">
                  {% csrf_token %}
                  <div class="mb-3">
                    <label for="firstname" class="form-label">First Name</label>
                    {{form.first_name}}
                    {% comment %} <input
                      type="text"
                      class="form-control"
                      id="username"
                      name="username"
                      placeholder="Enter your username"
                      autofocus
                    /> {% endcomment %}
                  </div>
                  <div class="mb-3">
                    <label for="lastname" class="form-label">Last Name</label>
                    {{form.last_name}}
                    {% comment %} <input
                      type="text"
                      class="form-control"
                      id="username"
                      name="username"
                      placeholder="Enter your username"
                      autofocus
                    /> {% endcomment %}
                  </div>
                  <div class="mb-3">
                    <label for="mobile" class="form-label">Mobile</label>
                    {% comment %} <input type="text" class="form-control" id="email" name="email" placeholder="Enter your email" /> {% endcomment %}
                    {{form.country_code}}
                    {{form.mobile}}
                  </div>
                  <div class="mb-3">
                    <label for="email" class="form-label">Email</label>
                    {% comment %} <input type="text" class="form-control" id="email" name="email" placeholder="Enter your email" /> {% endcomment %}
                    {{form.email}}
                  </div>
                  <div class="mb-3 form-password-toggle">
                    <label class="form-label" for="password">Password</label>
                    <div class="input-group input-group-merge">
                      {% comment %} <input
                        type="password"
                        id="password"
                        class="form-control"
                        name="password"
                        placeholder="&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;"
                        aria-describedby="password"
                      /> {% endcomment %}
                      {{form.password1}}
                      <span class="input-group-text cursor-pointer"><i class="bx bx-hide"></i></span>
                    </div>
                  </div>

                  <div class="mb-3 form-password-toggle">
                    <label class="form-label" for="password">Confirm Password</label>
                    <div class="input-group input-group-merge">
                      {% comment %} <input
                        type="password"
                        id="password"
                        class="form-control"
                        name="password"
                        placeholder="&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;&#xb7;"
                        aria-describedby="password"
                      /> {% endcomment %}
                      {{form.password2}}
                      <span class="input-group-text cursor-pointer"></span>
                    </div>
                  </div>
              
                  <div class="mb-3">
                    <div class="form-check">
                      {% comment %} <input class="form-check-input" type="checkbox" id="terms-conditions" name="terms" /> {% endcomment %}
                      {{form.terms_and_condition}}
                      <label class="form-check-label" for="terms-conditions">
                        I agree to
                        <a href="javascript:void(0);">privacy policy & terms</a>
                      </label>
                    </div>
                  </div>
                  <button class="btn btn-primary d-grid w-100">Sign up</button>
                </form>
            
                <p class="text-center">
                  <span>Already have an account?</span>
                  <a href="{% url 'login' %}">
                    <span>Sign in instead</span>
                  </a>
                </p>
              </div>
            </div>
            <!-- Register Card -->
        </div>
      </div>
    </div>

    <!-- / Content -->

    {% include 'base/js.html' %}
    <!-- Page JS -->

    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <script src="{% static 'assets/extra-libs/countrycode/js/intlTelInput.js' %}"></script>
    
    <script>
      function checkempty() {
        var $nonempty = $('#error-msg').filter(function () {
          return $(this).text() == ''
        });
        if ($nonempty.length > 0) { // if empty spans available
          $('#register_btn').prop("disabled", false); // disable button
        } else {
          $('#register_btn').prop("disabled", true); // otherwise enable it
        }
      }
    </script>
  <script>
    // get the country data from the plugin
    var countryData = window.intlTelInputGlobals.getCountryData(),
      input = document.querySelector("#id_mobile"),
      addressDropdown = document.querySelector("#id_country_code"),
      errorMsg = document.querySelector("#error-msg"),
      validMsg = document.querySelector("#valid-msg");

    var errorMap = ["Invalid number", "Invalid country code", "Too short", "Too long", "Invalid number"];

    var iti = window.intlTelInput(input, {
      utilsScript: "{% static 'assets/extra-libs/countrycode/js/utils.js' %}",
    });

    var reset = function () {
      input.classList.remove("error");
      errorMsg.innerHTML = "";
      errorMsg.classList.add("hide");
      validMsg.classList.add("hide");
    };

    input.addEventListener('blur', function () {
      reset();
      if (input.value.trim()) {
        if (iti.isValidNumber()) {
          validMsg.classList.remove("hide");
        } else {
          input.classList.add("error");
          var errorCode = iti.getValidationError();
          errorMsg.innerHTML = errorMap[errorCode];
          errorMsg.classList.remove("hide");
        }
      }
      checkempty();
    });

    // populate the country dropdown
    for (var i = 0; i < countryData.length; i++) {
      var country = countryData[i];
      var optionNode = document.createElement("option");
      optionNode.value = country.dialCode;
      var textNode = document.createTextNode(country.dialCode);
      optionNode.appendChild(textNode);
      addressDropdown.appendChild(optionNode);
    }
    // set it's initial value
    addressDropdown.value = iti.getSelectedCountryData().dialCode;

    // listen to the telephone input for changes
    input.addEventListener('countrychange', function (e) {
      addressDropdown.value = iti.getSelectedCountryData().dialCode;
    });

    // listen to the address dropdown for changes
    addressDropdown.addEventListener('change', function () {
      iti.setCountry(this.value);
    });
    $("#id_mobile").attr("placeholder", "Phone No..")
    input.addEventListener('change', reset);
    input.addEventListener('keyup', reset);

  </script>
  <script>
    $(".preloader ").fadeOut();
  </script>
  <script>
    $(document).ready(function () {
      $('#register').on('submit', function () {
        var form = $(this);
        $.ajax({
          url: form.attr('data-url'),
          data: form.serialize(),
          type: form.attr('method'),
          dataType: 'json',
          success: function (data) {
            location.replace('{% url "base:otp_verify" %}')
          },
          error: function (data) {
            $("#password2").text(data.responseJSON.password2)
            $("#first_name").text(data.responseJSON.first_name)
            $("#last_name").text(data.responseJSON.last_name)
            $("#mobile").text(data.responseJSON.mobile)
            $("#email").text(data.responseJSON.email)
            $("#password1").text(data.responseJSON.password1)

          }
        })
        return false;
      })
    })
  </script>
  </body>
</html>